(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(6),o=n.n(c),s=(n(13),n(8)),i=n(2),l=n.p+"static/media/logo.bbe2a6ea.svg",u=n(0);var d=function(){return Object(u.jsx)("header",{className:"header",children:Object(u.jsx)("img",{className:"header__logo",src:l,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f"})})},m=r.a.createContext();var f=function(e){var t=e.name,n=e.link,a=e.likes,c=e.card,o=e.onCardClick,s=e.onCardLike,i=e.onCardDelete,l=r.a.useContext(m),d=c.owner._id===l._id,f="element__delete ".concat(d?"element__delete_visible":"element__delete_hidden"),p=c.likes.some((function(e){return e._id===l._id})),_="element__like ".concat(p&&"element__like_active");return Object(u.jsxs)("li",{className:"element",children:[Object(u.jsx)("button",{className:f,onClick:function(){i(c)}}),Object(u.jsx)("div",{className:"element__image-container",children:Object(u.jsx)("img",{className:"element__image",src:n,alt:t,onClick:function(){o(c)}})}),Object(u.jsx)("h2",{className:"element__title",children:t}),Object(u.jsxs)("div",{className:"element__like-container",children:[Object(u.jsx)("button",{className:_,type:"submit",onClick:function(){s(c)}}),Object(u.jsx)("div",{className:"element__like-counter",children:a.length})]})]})};var p=function(e){var t=e.cards,n=e.onEditProfile,a=e.onAddPlace,c=e.onEditAvatar,o=e.onCardClick,s=e.onCardLike,i=e.onCardDelete,l=r.a.useContext(m);return Object(u.jsxs)("main",{className:"content",children:[Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsx)("img",{className:"profile__avatar",src:l.avatar,alt:"\u0430\u0432\u0430\u0442\u0430\u0440"}),Object(u.jsx)("div",{className:"profile__hidden-avatar",onClick:c}),Object(u.jsxs)("div",{className:"profile__info",children:[Object(u.jsx)("h1",{className:"profile__title",children:l.name}),Object(u.jsx)("button",{className:"profile__button",type:"button",onClick:n}),Object(u.jsx)("p",{className:"profile__subtitle",children:l.about})]}),Object(u.jsx)("button",{className:"profile__button-add",type:"button","aria-label":"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c_\u044d\u043b\u0435\u043c\u0435\u043d\u0442",onClick:a})]}),Object(u.jsx)("section",{className:"elements",children:Object(u.jsx)("ul",{className:"elements__grid-container",children:t.map((function(e){return Object(u.jsx)(f,{name:e.name,link:e.link,likes:e.likes,card:e,onCardClick:o,onCardLike:s,onCardDelete:i},e._id)}))})})]})};var _=function(){return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsxs)("p",{className:"footer__copyright",children:["\xa9 ","".concat((new Date).getFullYear()," Mesto Rusia")]})})};var j=function(e){var t=e.card,n=e.onClose,a=!Boolean("{}"===JSON.stringify(t))&&"popup_opened";return Object(u.jsx)("div",{className:"popup popup_type_image ".concat(a),children:Object(u.jsxs)("figure",{className:"popup__container popup__container-for-image",tabIndex:"0",children:[Object(u.jsx)("button",{className:"popup__close",type:"button",onClick:n}),Object(u.jsx)("img",{className:"popup__element-image",src:t.link,alt:t.name}),Object(u.jsx)("figcaption",{className:"popup__image-caption",children:t.name})]})})},b=n(7),h=new function e(t){var n=this;Object(b.a)(this,e),this._onError=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},this.getUserInfo=function(){return fetch("".concat(n._url,"users/me"),{method:"GET",headers:n._headers}).then(n._onError)},this.setUserInfo=function(e){return fetch("".concat(n._url,"users/me"),{method:"POST",headers:n._headers,body:JSON.stringify(e)}).then(n._onError)},this.getCards=function(){return fetch("".concat(n._url,"cards"),{method:"GET",headers:n._headers}).then(n._onError)},this.addCard=function(e){return fetch("".concat(n._url,"cards"),{method:"POST",headers:n._headers,body:JSON.stringify(e)}).then(n._onError)},this.removeCard=function(e){return fetch("".concat(n._url,"cards/").concat(e),{method:"DELETE",headers:n._headers}).then(n._onError)},this.setUserInfo=function(e){return fetch("".concat(n._url,"users/me"),{method:"PATCH",headers:n._headers,body:JSON.stringify(e)}).then(n._onError)},this.setAvatar=function(e){return fetch("".concat(n._url,"users/me/avatar"),{method:"PATCH",headers:n._headers,body:JSON.stringify(e)}).then(n._onError)},this.toggleLike=function(e,t){return fetch("".concat(n._url,"cards/likes/").concat(t),{method:e,headers:n._headers}).then(n._onError)},this._url=t.url,this._headers=t.headers}({url:"https://mesto.nomoreparties.co/v1/cohort-30/",headers:{authorization:"c5a5cb5f-db7e-4ac2-924a-a6deb50d8693","content-type":"application/json"}});var O=function(e){var t=e.name,n=e.title,a=e.buttonText,r=e.isOpen,c=e.onClose,o=e.onSubmit,s=e.children,i=r&&"popup_opened";return Object(u.jsx)("div",{className:"popup ".concat(i),children:Object(u.jsxs)("div",{className:"popup__container",tabIndex:"0",children:[Object(u.jsx)("button",{className:"popup__close",type:"button",onClick:c}),Object(u.jsxs)("form",{name:t,className:"form",onSubmit:o,noValidate:!0,children:[Object(u.jsxs)("fieldset",{className:"form__input-container",children:[Object(u.jsx)("h2",{className:"form__title",children:n}),Object(u.jsx)(u.Fragment,{children:s})]}),Object(u.jsx)("button",{className:"form__button-save",type:"submit",children:a})]})]})})};var x=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,c=r.a.useState(""),o=Object(i.a)(c,2),s=o[0],l=o[1],d=r.a.useState(""),f=Object(i.a)(d,2),p=f[0],_=f[1],j=r.a.useContext(m);return r.a.useEffect((function(){l(j.name),_(j.about)}),[t,j]),Object(u.jsxs)(O,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:s,about:p},"setUserInfo")},children:[Object(u.jsxs)("label",{className:"form__field",children:[Object(u.jsx)("input",{name:"name",type:"text",className:"form__input form__input_type_name",id:"profile-input-name",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",minLength:"2",maxLength:"40",required:!0,onChange:function(e){l(e.target.value)},value:s||""}),Object(u.jsx)("span",{className:"form__input-error profile-input-name-error"})]}),Object(u.jsxs)("label",{className:"form__field",children:[Object(u.jsx)("input",{name:"about",type:"text",className:"form__input form__input_type_profession",id:"profile-input-profession",placeholder:"\u041a\u043e\u0440\u043e\u0442\u043a\u043e \u043e\u0441\u0435\u0431\u0435",minLength:"2",maxLength:"200",required:!0,onChange:function(e){_(e.target.value)},value:p||""}),Object(u.jsx)("span",{className:"form__input-error profile-input-profession-error"})]})]})};var v=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,c=r.a.useRef(null);return r.a.useEffect((function(){c.current.value=null}),[t]),Object(u.jsx)(O,{name:"edit-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:c.current.value},"setAvatar")},children:Object(u.jsxs)("label",{className:"form__field",children:[Object(u.jsx)("input",{ref:c,name:"avatar",type:"url",className:"form__input form__input_type_avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",id:"profile-input-avatar",required:!0}),Object(u.jsx)("span",{className:"form__input-error profile-input-avatar-error"})]})})};var C=function(e){var t=e.onAddPlace,n=e.isOpen,a=e.onClose,c=r.a.useState(""),o=Object(i.a)(c,2),s=o[0],l=o[1],d=r.a.useState(""),m=Object(i.a)(d,2),f=m[0],p=m[1];return r.a.useEffect((function(){l(""),p("")}),[n]),Object(u.jsxs)(O,{name:"creat-element",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:n,onClose:a,onSubmit:function(e){e.preventDefault(),t({name:s,link:f})},children:[Object(u.jsxs)("label",{className:"form__field",children:[Object(u.jsx)("input",{name:"name",type:"text",className:"form__input form__input_type_place",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"input-place",minLength:"2",maxLength:"30",required:!0,onChange:function(e){l(e.target.value)},value:s}),Object(u.jsx)("span",{className:"form__input-error input-place-error"})]}),Object(u.jsxs)("label",{className:"form__field",children:[Object(u.jsx)("input",{name:"link",type:"url",className:"form__input form__input_type_place-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"input-place-link",required:!0,onChange:function(e){p(e.target.value)},value:f}),Object(u.jsx)("span",{className:"form__input-error input-place-link-error"})]})]})};var g=function(e){var t=e.isOpen,n=e.onClose,a=e.onDeleteCard;return Object(u.jsx)(O,{name:"delete-element",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a()}})};var N=function(){var e=r.a.useState(!1),t=Object(i.a)(e,2),n=t[0],a=t[1],c=r.a.useState(!1),o=Object(i.a)(c,2),l=o[0],f=o[1],b=r.a.useState(!1),O=Object(i.a)(b,2),N=O[0],k=O[1],y=r.a.useState(!1),S=Object(i.a)(y,2),E=S[0],L=S[1],P=r.a.useState({}),T=Object(i.a)(P,2),D=T[0],A=T[1],U=r.a.useState({}),I=Object(i.a)(U,2),J=I[0],F=I[1],q=r.a.useState({}),w=Object(i.a)(q,2),B=w[0],G=w[1],H=r.a.useState([]),M=Object(i.a)(H,2),R=M[0],z=M[1];r.a.useEffect((function(){Promise.all([h.getUserInfo(),h.getCards()]).then((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];G(n),z(a)})).catch((function(e){console.log(e)}))}),[]);var V=function(e,t){h[t](e).then((function(e){G(e),Y()})).catch((function(e){console.log(e)}))},Y=function(){a(!1),f(!1),k(!1),L(!1),F({})};return Object(u.jsx)(m.Provider,{value:B,children:Object(u.jsx)("div",{className:"common",children:Object(u.jsxs)("div",{className:"page",children:[Object(u.jsx)(d,{}),Object(u.jsx)(p,{onEditProfile:function(){a(!0)},onAddPlace:function(){f(!0)},onEditAvatar:function(){k(!0)},onCardClick:function(e){F(e)},cards:R,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===B._id})),n=t?"DELETE":"PUT";h.toggleLike(n,e._id,!t).then((function(t){z((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){A(e),L(!0)}}),Object(u.jsx)(_,{}),Object(u.jsx)(x,{isOpen:n,onClose:Y,onUpdateUser:V}),Object(u.jsx)(C,{isOpen:l,onClose:Y,onAddPlace:function(e){h.addCard(e).then((function(e){z([e].concat(Object(s.a)(R))),Y()})).catch((function(e){console.log(e)}))}}),Object(u.jsx)(v,{isOpen:N,onClose:Y,onUpdateAvatar:V}),Object(u.jsx)(g,{isOpen:E,onClose:Y,onDeleteCard:function(){h.removeCard(D._id).then((function(){z((function(e){return e.filter((function(e){return e._id!==D._id&&e}))})),Y()})).catch((function(e){console.log(e)}))}}),Object(u.jsx)(j,{card:J,onClose:Y})]})})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,16)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};o.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(N,{})}),document.getElementById("root")),k()}},[[15,1,2]]]);
//# sourceMappingURL=main.aa0da8d1.chunk.js.map